Attribute VB_Name = "pouziStyl"
Sub applyStyle()
Attribute applyStyle.VB_ProcData.VB_Invoke_Func = " \n14"
'
' ApplyStyle Makro
'
    Dim tRng As Range   'total range
    Dim row As Range
    Dim tabulka As String
    Dim nazev As Range
    Dim exLibris As Range
    Dim datum As Range
    'every sheet is slightly different, so I have to adjust settings
    
    If ActiveSheet.Name = "Knihy_L'uboš" Then
        Worksheets("Knihy_L'uboš").Activate
        tabulka = "Tabu1"
        Set nazev = Range("A4:A2500,N4:N2500")
        Set exLibris = Range("X4:Y2500,AD4:AD2500")
        Set datum = Range("AF4:AF2500")
        Set tRng = Range("A4:AF2500")
    End If
    If ActiveSheet.Name = "Knihy_Žanetka" Then
        Worksheets("Knihy_Žanetka").Activate
        tabulka = "Tabu2"
        Set nazev = Range("A4:A2500,N4:N2500")
        Set exLibris = Range("X4:Y2500,AD4:AD2500")
        Set datum = Range("AF4:AF2500")
        Set tRng = Range("A4:AF2500")
        Set tRng = Range("A4:A2500")
    End If
    If ActiveSheet.Name = "LP" Then
        Worksheets("LP").Activate
        tabulka = "Tabu3"
        Set nazev = Range("A4:B500")
        Set exLibris = Range("A1")
        Set datum = Range("L4:L500")
        Set tRng = Range("A4:A500")
    End If
    
    Call TurnOffCalc
    Dim strikeRange As String
    For Each row In Range("N4:N2500")
        If row.Font.Strikethrough = True Then
            strikeRange = strikeRange + "A" + CStr(row.row) + ":AF" + CStr(row.row) + ","
        End If
    Next row
    Call progressBar(41, "hotové")    'set progress bar to 41 perc.
    tRng.ClearFormats
    ActiveSheet.ListObjects(tabulka).TableStyle = "TableStyleMedium1"
    nazev.Font.Bold = True
    exLibris.Font.Name = "Webdings"
    datum.NumberFormat = "d.m.yyyy"
    If Len(strikeRange) > 0 Then
        strikeRange = Left(strikeRange, Len(strikeRange) - 1)
        Range(strikeRange).Font.Strikethrough = True
    End If
    With tRng
        .WrapText = True
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    Call progressBar(98, "hotové")
    Call TurnOnCalc
    Call tlacitko_prvy_zaznam
End Sub
   End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("$AH$25:$AI$25").Select
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    
    Range("$AH$27:$AI$27").Select
    Range("$AH$27:$AI$27").HorizontalAlignment = xlLeft
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
    End With
    Range("$AH$36:$AI$36").Select
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
    End With
    
    'set alignment
    Range("$AH$17:$AI$25").HorizontalAlignment = xlRight
    Range("$AH$28:$AI$36").HorizontalAlignment = xlRight
    Range("$AH$17:$AI$25").VerticalAlignment = xlBottom
    Range("$AH$28:$AI$36").VerticalAlignment = xlBottom

End Sub

