Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox2, 19, 0, MSForms, CheckBox"
Attribute VB_Control = "CheckBox1, 18, 1, MSForms, CheckBox"
Option Explicit
Private alreadyPrompted As Boolean

Private Sub Worksheet_Activate()
    If alreadyPrompted Then Exit Sub
    If Range("AL10").Value / Range("AI10").Value < 0.15 Then
        Dim current As Double
        current = Round(((Range("AL10").Value / Range("AI10").Value) * 100), 1)
        MsgBox "Máš preèítaných menej než 15 percent kníh!" & vbNewLine & "Momentálne " & current & "%."
        alreadyPrompted = True
    End If
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim cell As Range
    Dim ISBN As String
    
    For Each cell In Range("AF4:AF2500")
        If Not Intersect(Target, cell) Is Nothing Then
            If cell.Value = "Dnes" Or cell.Value = "dnes" Or cell.Value = "d" Then
                cell.Value = Format(Date, "d.m.yyyy")
            End If
        End If
    Next cell
    ActiveSheet.Calculate
    
   For Each cell In Range("T4:T2500")
        If Not Intersect(Target, cell) Is Nothing Then
            If CheckBox1.Value = True Then
                ISBN = VBA.Replace(cell.Value, "-", "")
                If IsEmpty(cell.offset(0, -6)) And Len(cell.Value) > 5 Then 'if Title is empty and text at least 5 chars
                    fillBookByISBN ISBN, cell.row 'multiple arguments has to be without ()
                End If
            End If
        End If
    Next cell
End Sub
